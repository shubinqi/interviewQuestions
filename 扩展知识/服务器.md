<!--
 * @Author: Shu Binqi
 * @Date: 2023-03-17 23:23:13
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-18 15:48:00
 * @Description: 服务器（8题）
 * @Version: 1.0.0
 * @FilePath: \interviewQuestions\扩展知识\服务器.md
-->

#### 前端需要学习服务器哪些内容？

前端开发人员需要了解服务器的一些基本概念和技术，以便更好地与后端开发人员合作构建高效、可靠的 Web 应用程序。以下是一些前端开发人员可能需要学习的服务器方面的内容：

1. **服务器端编程语言**：了解服务器端编程语言（如 PHP、Java、Python、Node.js 等）的基本语法和特点，以便理解后端代码，并能够与后端开发人员进行交流。
1. **Web 服务器**：了解 Web 服务器的基本概念和工作原理，包括处理 HTTP 请求和响应、负载均衡、缓存等。
1. **数据库**：了解如何在服务器上安装和配置数据库，以及如何使用 SQL 语言来查询和更新数据库中的数据。
1. **API 设计和开发**：了解如何设计和实现 RESTful API，以便提供 Web 应用程序所需的数据和功能。
1. **安全性**：了解如何保护 Web 应用程序的安全性，包括防止跨站脚本攻击、SQL 注入等攻击。
1. **网络协议**：了解一些基本的网络协议，如 TCP/IP、HTTP、HTTPS 等，以便更好地理解 Web 应用程序的工作原理。
1. **Linux 系统管理**：了解如何在 Linux 服务器上安装、配置和管理 Web 应用程序所需的软件和服务。

总之，前端开发人员需要了解一些基本的服务器技术和概念，以便与后端开发人员合作构建高效、可靠的 Web 应用程序。

### 一、Web 服务器

#### Web 服务器是什么？

Web 服务器是一种软件，它主要的功能是提供网上信息浏览服务，即向客户端（浏览器）提供 Web 内容（例如 HTML 页面、图片、视频、音频等）。 Web 服务器是互联网的核心组件之一，是在客户端和服务器之间传输数据的桥梁。Web 服务器接收客户端请求后，会解析请求并返回相应的 Web 内容。

Web 服务器的概念与基本原理可以从以下两个方面来了解：主流 Web 服务器和 Web 应用程序容器概念与基本原理。主流 Web 服务器包括 Apache、IIS、Nginx 等，它们是用来处理 HTTP 请求的软件。而 Web 应用程序容器则是一个运行在 Web 服务器上的软件，它提供了 Web 应用程序的运行环境和支持。

Web 应用程序容器是 Web 服务器的升级版，它不仅提供了静态网页服务，还支持动态网页服务。Web 应用程序容器的基本工作原理是：当客户端发起请求时，Web 服务器会将请求发送给 Web 应用程序容器。Web 应用程序容器会根据请求的 URL 将请求转发给相应的 Web 应用程序，并将处理结果返回给 Web 服务器，最终由 Web 服务器将处理结果返回给客户端。

动态技术是 Web 应用程序容器的重要组成部分，它们可以让 Web 应用程序容器动态生成 Web 内容。常见的动态技术包括：CGI、PHP、JSP、ASP 等。这些技术都是用来动态生成 Web 内容的，它们可以在 Web 应用程序容器中运行，生成 HTML 页面、图片、视频、音频等内容。

Web 服务器和 Web 应用程序容器是互联网的核心组件之一，它们的作用是将客户端和服务器连接起来，实现数据的传输和交互。Web 服务器和 Web 应用程序容器的发展，推动了互联网的快速发展，使得互联网成为了人类社会最重要的信息资源之一。

#### Web 服务器工作原理？

Web 服务器是一种软件，它的主要功能是接收客户端的请求并向客户端发送响应。Web 服务器工作的基本原理可以通过以下几个步骤来描述:

1. **连接过程**：Web 服务器和浏览器之间建立一种连接，这个连接是通过 TCP/IP 协议实现的。当用户在浏览器中输入 URL 时，浏览器会向 Web 服务器发送一个 HTTP 请求。Web 服务器会接收到这个请求并对其进行解析。
1. **请求过程**：Web 服务器接收到 HTTP 请求后，会根据请求的内容进行相应的处理。这个处理过程可能包括读取请求的内容，执行请求的操作，从数据库中获取信息等等。Web 服务器还可以根据请求的 URL，将请求转发到其他的 Web 服务器上进行处理。
1. **应答过程**：Web 服务器处理完 HTTP 请求后，会向浏览器发送一个 HTTP 响应。这个响应包括 HTTP 状态码、响应头和响应体等内容。浏览器接收到 HTTP 响应后，会根据响应的内容进行相应的处理，例如显示网页内容，下载文件等等。
1. **关闭连接**：当 Web 服务器完成 HTTP 响应后，会关闭与浏览器之间的连接。如果浏览器需要继续向 Web 服务器发送请求，它需要重新建立一个新的连接。

除了上述基本的工作原理，Web 服务器还可以提供其他的功能，例如:

1. **静态文件服务**：Web 服务器可以向浏览器提供静态文件，例如 HTML、CSS、JavaScript、图片、视频等等。
1. **动态内容生成**：Web 服务器可以通过执行服务器端脚本，生成动态的内容，例如从数据库中读取信息，生成网页内容等等。
1. **负载均衡**：Web 服务器可以将请求转发到多个 Web 服务器上，从而实现负载均衡，提高 Web 应用的性能和可靠性。
1. **安全控制**：Web 服务器可以提供一些安全控制功能，例如认证、授权、加密等等。

总之，Web 服务器是实现 Web 应用的关键组件之一，它的工作原理基于 HTTP 协议和 TCP/IP 协议，通过连接、请求、应答和关闭连接等步骤来实现对客户端请求的处理和响应。

#### 负载均衡是什么？有什么作用？

负载均衡是一种基本的网络服务，可以提高整体服务性能，降低单个设备的资源压力，加强网络处理能力，增加吞吐量，提高网络的灵活性和可用性。负载均衡建立在现有网络结构之上，通过算法调整负载，尽力将网络流量平均分发到多个服务器上，以提高系统整体的响应速度和可用性。负载均衡设备可以分为软件负载均衡和硬件负载均衡两种类型，常见的负载均衡算法有轮询算法、加权轮询算法、最小连接数算法、IP 哈希算法等。

负载均衡的主要作用如下：

1. 提高系统整体的响应速度和可用性。负载均衡可以将客户端请求分散到多台服务器上，从而避免单台服务器负荷过重而导致服务不可用的情况。当一台服务器出现故障时，负载均衡可以将请求转发到其他健康的服务器上，从而保证服务的连续性和可用性。
1. 增加吞吐量。负载均衡可以将客户端请求分散到多台服务器上，从而提高系统的吞吐量。
1. 加强网络数据处理能力。负载均衡可以将客户端请求分散到多台服务器上，从而减轻单台服务器的压力，提高网络数据处理能力。
1. 提高网络的灵活性和可用性。负载均衡可以根据实际情况动态调整服务器的负载，从而提高网络的灵活性和可用性。

总之，负载均衡是高并发、高可用系统必不可少的关键组件，可以提高系统的性能和可用性，减轻单个设备的资源压力，提高网络的灵活性和可用性。

### 二、API

#### 如何设计和实现 RESTful API？

RESTful 是一种用于设计 Web 数据接口的 API 设计规范，本质上是一种基于超媒体构建分布式系统的架构风格。RESTful 的核心思想是客户端发出的数据操作指令都是"动词 + 宾语"，并且使用统一接口，包括使用标准 HTTP 谓词对资源执行操作，最常见的操作是 GET、POST、PUT、PATCH 和 DELETE。

下面是设计和实现 RESTful API 的步骤和注意事项：

1. **基于资源的设计原则**：RESTful API 的设计应该基于资源而不是基于操作，每个资源都应该有一个独立的标识符，例如 URI 或 URL。例如，一个订单资源的 URI 可以是/orders/123，其中"123"是订单的唯一标识符。
1. **使用 HTTP 谓词执行操作**：RESTful API 使用标准 HTTP 谓词对资源执行操作。最常见的操作是 GET、POST、PUT、PATCH 和 DELETE。例如，使用 GET 谓词来获取订单资源的信息，使用 POST 谓词来创建新的订单资源，使用 PUT 谓词来更新订单资源，使用 DELETE 谓词来删除订单资源。
1. **使用 HTTP 状态码**：RESTful API 使用 HTTP 状态码来表示操作的结果。例如，使用 200 状态码表示成功的 GET 操作，使用 201 状态码表示成功的 POST 操作，使用 204 状态码表示成功的 DELETE 操作。
1. **使用 JSON 作为交换格式**：RESTful API 使用 JSON 作为交换格式，因为 JSON 轻量级、易于阅读和编写，而且广泛支持。
1. **对 RESTful Web API 进行版本控制**：由于 Web API 一直在变化，可能会添加新的资源集合，资源之间的关系可能会更改，并且可能会修改资源中的数据结构。因此，需要对 RESTful Web API 进行版本控制，以便现有客户端应用程序能够继续不变地正常运行，同时允许新客户端应用程序利用新功能和新资源。
1. **使用 OpenAPI 规范**：OpenAPI 规范是一组关于如何设计 RESTful API 的强制性准则，有助于互操作性。Swagger 等工具可以从 API 协定生成客户端库或文档。

下面是一个使用 Node.js 和 Express 框架实现的简单的 RESTful API 的示例：

```
const express = require('express');
const app = express();

// 获取所有订单
app.get('/orders', (req, res) => {
  // TODO: 获取所有订单的逻辑
  res.send('Get all orders');
});

// 获取指定订单
app.get('/orders/:id', (req, res) => {
  const orderId = req.params.id;
  // TODO: 获取指定订单的逻辑
  res.send(`Get order ${orderId}`);
});

// 创建新订单
app.post('/orders', (req, res) => {
  // TODO: 创建新订单的逻辑
  res.send('Create a new order');
});

// 更新指定订单
app.put('/orders/:id', (req, res) => {
  const orderId = req.params.id;
  // TODO: 更新指定订单的逻辑
  res.send(`Update order ${orderId}`);
});

// 删除指定订单
app.delete('/orders/:id', (req, res) => {
  const orderId = req.params.id;
  // TODO: 删除指定订单的逻辑
  res.send(`Delete order ${orderId}`);
});

app.listen(3000, () => {
  console.log('Server is running on port 3000');
});
```

以上代码实现了一个简单的订单 RESTful API，包括获取所有订单、获取指定订单、创建新订单、更新指定订单和删除指定订单。这些操作分别对应 HTTP 谓词 GET、POST、PUT 和 DELETE。

### 三、安全

#### 什么是 SQL 注入？如何防止 SQL 注入？

SQL 注入是指攻击者通过在一个 Web 表单提交恶意 SQL 查询语句，从而获得该 Web 应用程序中与数据库交互的权限，进而对数据库中的数据进行非法访问或篡改的一种安全漏洞。攻击者可以通过各种方式在 SQL 查询中注入恶意代码，从而实现控制数据库的目的。以下是一些 SQL 注入攻击的例子:

1. **检索隐藏数据**。攻击者可以修改 SQL 查询，以返回其他结果。例如，原查询 `SELECT _ FROM products WHERE category = 'Gifts' AND released = 1`，攻击者可以通过修改查询语句为 `SELECT _ FROM products WHERE category = 'Gifts'--' AND released = 1`，来获取所有分类为“Gifts”的产品，而不考虑是否发布。
1. **颠覆应用程序逻辑**。攻击者可以更改查询以干扰应用程序的逻辑。例如，原查询 `SELECT _ FROM users WHERE username = 'wiener' AND password = 'bluecheese'`，攻击者可以通过修改查询语句为 `SELECT _ FROM users WHERE username = 'administrator'--' AND password = ''`，来获取管理员的访问权限，而不需要知道管理员的密码。
1. **UNION 攻击**。攻击者可以从不同的数据库表中检索数据。例如，原查询 `SELECT name, description FROM products WHERE category = 'Gifts'`，攻击者可以通过修改查询语句为 `SELECT name, description FROM products WHERE category = 'Gifts' UNION SELECT username, password FROM users`，来获取所有分类为“Gifts”的产品和用户的用户名和密码。

为了防止 SQL 注入攻击，可以采取以下措施:

1. **过滤输入内容，校验字符串**。过滤输入内容就是在数据提交到数据库之前，就把用户输入中的不合法字符剔除掉。可以使用编程语言提供的处理函数或自己的正则表达式函数实现。
1. **使用参数化查询**。参数化查询是将 SQL 查询语句和参数分开，而不是将它们拼接在一起。这种方法可以防止攻击者在输入参数中注入恶意代码，因为参数化查询会将输入参数视为数据，而不是代码。
1. **最小化数据库的权限**。通过最小化数据库的权限，可以降低攻击者的攻击范围。例如，只允许应用程序访问指定的表或列，或者只允许应用程序执行特定的存储过程。
1. **对敏感数据进行加密**。对敏感数据进行加密可以防止攻击者在获取数据后直接使用。

在具体的实现中，可以使用以下方式防止 SQL 注入攻击:

1. **使用预处理语句**。预处理语句是一种在执行 SQL 查询之前将查询语句和参数分开的技术。在 Java 中，可以使用 PreparedStatement 对象来实现预处理语句。例如，可以将查询语句 SELECT \* FROM products WHERE category = ? 中的参数用问号代替，然后使用 setString() 方法设置参数的值。
1. **使用存储过程**。存储过程是一种预编译的 SQL 语句，可以在数据库中存储并重复使用。存储过程可以防止 SQL 注入攻击，因为存储过程的参数是预定义的，并且预先编译过的。
1. **使用 ORM 框架**。ORM 框架可以将数据库操作封装为对象操作，从而避免手动编写 SQL 语句。ORM 框架通常会使用参数化查询来防止 SQL 注入攻击。
1. **使用安全的 API**。在使用数据库 API 时，应该使用安全的 API，例如 PDO 和 mysqli，它们提供了预处理语句和其他安全功能。

### 四、服务器架构

#### 常见服务器架构有哪些？

常见的服务器架构有以下几种：

1. **单机架构**：所有应用都部署在一台物理或虚拟机上，适合小型应用或测试环境，简单、易部署、易维护。
1. **分层架构**：将应用按照不同的功能层次分别部署到不同的物理或虚拟机上，例如将数据库、应用服务器、Web 服务器分别部署在不同的机器上，通过接口或服务进行通信。适用于中小型的应用，提高了应用的可伸缩性和可维护性。
1. **集群架构**：将应用部署在多台物理或虚拟机上，并通过负载均衡器将流量分发到不同的机器上，提高了应用的可伸缩性和可用性。
1. **分布式架构**：将应用拆分为不同的服务，分别部署在不同的物理或虚拟机上，通过网络协议进行通信，适用于大型应用，提高了应用的可伸缩性和可维护性，但也增加了开发和部署的复杂度。
1. **微服务架构**：将应用按照业务功能划分为不同的微服务，每个微服务都是独立的进程，通过轻量级的通信协议进行通信。适用于大型复杂的分布式应用，提高了应用的可伸缩性和可维护性，但也增加了部署和运维的复杂度。

以上几种架构各有优缺点，需要根据具体的业务需求和技术实现来选择合适的架构。同时，不同的架构也需要不同的管理和运维方式，需要根据具体情况进行调整和优化。

#### 以上几种架构有什么优缺点？

以下是以上几种常见服务器架构的优缺点：

1. **单机架构**：

优点：

- 部署简单、易于维护；
- 适用于小型应用或测试环境。

缺点：

- 单点故障；
- 可用性和性能有限；
- 不适合大型高并发应用。

2. **分层架构**：

优点：

- 分层清晰，易于管理和维护；
- 可以根据需要扩展每个层级；
- 适用于中小型应用。

缺点：

- 可能会出现瓶颈问题，例如数据库成为性能瓶颈；
- 部署和维护需要更多的管理工作。

3. **集群架构**：

优点：

- 提高了可用性和性能；
- 可以通过水平扩展增加机器数量；
- 适用于中大型应用。

缺点：

- 部署和维护需要更多的管理工作；
- 会增加复杂性和成本。

4. **分布式架构**：

优点：

- 可以将应用拆分为多个服务，分别部署和维护；
- 可以通过分布式技术来提高可用性和性能；
- 适用于大型应用。

缺点：

- 增加了复杂性和成本；
- 需要更高的技术要求和管理能力。

5. **微服务架构**：

优点：

- 可以将应用拆分为独立的服务，方便管理和维护；
- 可以根据需要扩展每个服务；
- 可以通过分布式技术来提高可用性和性能；
- 适用于大型复杂的分布式应用。

缺点：

- 增加了复杂性和成本；
- 需要更高的技术要求和管理能力；
- 服务之间的通信需要处理好问题，否则会影响性能。
  需要根据具体的业务需求和技术实现来选择合适的架构。同时，不同的架构也需要不同的管理和运维方式，需要根据具体情况进行调整和优化。

#### 什么是负载均衡？

负载均衡是指将负载（工作任务）平衡地分摊到多个操作单元上进行运行，以协同完成工作任务，提高整体性能和可用性。在计算机网络中，负载通常指网络流量、CPU、磁盘驱动器等资源的负载。负载均衡的主要作用包括：

- **高并发处理能力**：通过算法调整负载，均匀地分配应用集群中各节点的工作量，提高应用集群的并发处理能力（吞吐量）。
- **伸缩性**：添加或减少服务器数量，然后由负载均衡进行分发控制。这使得应用集群具备伸缩性。
- **高可用**：负载均衡器可以监控服务器，当服务器不可用时，自动跳过，将请求分发给可用的服务器。这使得应用集群具备高可用的特性。
- **安全防护**：有些负载均衡软件或硬件提供了安全性功能，如黑白名单处理、防火墙、防 DDoS 攻击等。

负载均衡的实现方式有多种，其中比较常见的包括：

- **硬件负载均衡**：使用专门的负载均衡硬件设备，如 F5、Cisco ACE 等。
- **软件负载均衡**：使用软件实现负载均衡，如 Nginx、HAProxy、Apache 等。
- **DNS 负载均衡**：使用 DNS 服务器将请求分发到多个服务器上，如 Amazon Route 53、Alibaba Cloud DNS 等。
- **IP 负载均衡**：使用 IP 地址进行负载均衡，如 AWS Elastic Load Balancer（ELB）。

ELB 是 AWS 提供的一种完全托管的负载均衡服务，可以将传入的应用程序流量自动分配到跨 AWS 和本地资源的多个目标和虚拟设备。ELB 提供了四种不同类型的软件负载均衡器，包括应用程序负载均衡器(ALB)、网络负载均衡器(NLB)、网关负载均衡器(GWLB)和 Classic Load Balancer(CL).

在 IP 哈希法中，负载均衡器将对客户端 IP 地址执行名为哈希的数学计算，将客户端 IP 地址转换为数字，然后将该数字映射到各个服务器。当主负载均衡器故障时，可以使用浮动 IP 或其他灵活的方法来解决 IP 地址重新映射的问题，以便将用户请求转到第二个负载均衡器。
