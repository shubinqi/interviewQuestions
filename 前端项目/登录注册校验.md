<!--
 * @Author: Shu Binqi
 * @Date: 2023-03-27 10:41:35
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-27 11:03:47
 * @Description: 登录注册校验
 * @Version: 1.0.0
 * @FilePath: \pcc-webd:\BaiduSyncdisk\Git\0327-校验.md
-->

#### 常见登录注册校验条件

用户注册是网站或应用程序中非常重要的一个功能，需要进行严格的校验，以确保用户输入的数据正确、合法、安全。以下是用户注册常见的校验内容：

1. **用户名校验**：用户名应该是唯一的，长度在特定范围内，不能包含特殊字符，如空格、引号、尖括号等。
1. **密码校验**：密码应该是强度足够的，长度在特定范围内，包含大写字母、小写字母、数字、特殊字符等。
1. **确认密码校验**：确认密码应该与密码相同，以避免用户输入错误。
1. **电子邮箱校验**：电子邮箱应该符合标准格式，如包含“@”符号、一个或多个字母、数字、点号、减号等。
1. **手机号码校验**：手机号码应该符合标准格式，如以数字“1”开头，共 11 位数字等。
1. **邮政编码校验**：邮政编码应该符合标准格式，如以数字开头，共 6 位数字等。
1. **身份证号码校验**：身份证号码应该符合标准格式，如共 18 位数字或 17 位数字和一个字母，最后一位可能是数字或字母“X”。
1. **用户协议校验**：用户在注册时需要同意用户协议，否则无法完成注册。

#### 校验中文姓名

校验代码

```
function validateChineseName(name) {
  const regExp = /^[\u4e00-\u9fa5]{2,}$/; // 仅包含2个或以上汉字
  return regExp.test(name);
}
```

该函数接受一个字符串类型的中文姓名作为输入，如果该中文姓名符合规则，则返回 true，否则返回 false。

测试代码

```
const name = "张三";
const isValid = validateChineseName(name);
console.log(isValid); // true

const name2 = "zhangsan";
const isValid2 = validateChineseName(name2);
console.log(isValid2); // false
```

上述示例中，validateChineseName 函数校验 name 和 name2 两个字符串是否符合中文姓名规则，其中 name 符合规则，返回值为 true，而 name2 不符合规则，返回值为 false。

#### 校验密码复杂度

校验代码

```
function validatePassword(password) {
  const regExp = /^(?=._[a-z])(?=._[A-Z])(?=.\*\d)[a-zA-Z\d]{8,}$/; // 至少包含一个小写字母、一个大写字母和一个数字，长度至少为 8 位
  return regExp.test(password);
}

```

该函数接受一个字符串类型的密码作为输入，如果该密码符合规则，则返回 true，否则返回 false。

测试代码

```
const password = "Abc123456";
const isValid = validatePassword(password);
console.log(isValid); // true

const password2 = "abc123456";
const isValid2 = validatePassword(password2);
console.log(isValid2); // false

const password3 = "Abcdefg";
const isValid3 = validatePassword(password3);
console.log(isValid3); // false
```

上述示例中，validatePassword 函数校验 password、password2 和 password3 三个字符串是否符合密码规则，其中 password 符合规则，返回值为 true，而 password2 和 password3 不符合规则，返回值为 false。

#### 校验新旧密码是否相同

校验代码

```
function validatePasswordMatch(password, confirmPassword) {
  return password === confirmPassword;
}
```

该函数接受两个字符串类型的参数 password 和 confirmPassword，分别表示新密码和确认密码。如果两个参数的值相同，则返回 true，否则返回 false。

测试代码

```
const newPassword = "Abc12345!";
const confirmedPassword = "Abc12345!";
const isMatch = validatePasswordMatch(newPassword, confirmedPassword);
console.log(isMatch); // true

const newPassword2 = "Abc12345!";
const confirmedPassword2 = "Abc123456!";
const isMatch2 = validatePasswordMatch(newPassword2, confirmedPassword2);
console.log(isMatch2); // false
```

#### 校验手机号码

校验代码

```
function validatePhoneNumber(phoneNumber) {
  const regExp = /^1[3-9]\d{9}$/; // 以1开头，第二位为3~9，后面跟着9位数字
  return regExp.test(phoneNumber);
}
```

该函数接受一个字符串类型的手机号码作为输入，如果该手机号码符合规则，则返回 true，否则返回 false。

测试代码

```
const phoneNumber = "13912345678";
const isValid = validatePhoneNumber(phoneNumber);
console.log(isValid); // true

const phoneNumber2 = "12345678901";
const isValid2 = validatePhoneNumber(phoneNumber2);
console.log(isValid2); // false
```

上述示例中，validatePhoneNumber 函数校验 phoneNumber 和 phoneNumber2 两个字符串是否符合手机号码规则，其中 phoneNumber 符合规则，返回值为 true，而 phoneNumber2 不符合规则，返回值为 false。

#### 校验座机号码

校验代码

```
function validateTelephoneNumber(telephone) {
  const regExp = /^(0\d{2,3}-)?\d{7,8}$/; // 以0开头，后面跟着2或3位数字和-（可选），后面跟着7或8位数字
  return regExp.test(telephone);
}
```

该函数接受一个字符串类型的座机号码作为输入，如果该座机号码符合规则，则返回 true，否则返回 false。

测试代码

```
const telephone = "021-12345678";
const isValid = validateTelephoneNumber(telephone);
console.log(isValid); // true

const telephone2 = "01012345678";
const isValid2 = validateTelephoneNumber(telephone2);
console.log(isValid2); // true

const telephone3 = "12345678";
const isValid3 = validateTelephoneNumber(telephone3);
console.log(isValid3); // false
```

上述示例中，validateTelephoneNumber 函数校验 telephone、telephone2 和 telephone3 三个字符串是否符合座机号码规则，其中 telephone 和 telephone2 符合规则，返回值为 true，而 telephone3 不符合规则，返回值为 false。

#### 校验身份证号

校验代码

```
/**
 * @description: 验证身份证号正确性（包括省份、生日、性别、校验码校验）
 * @param {*} idCard
 * @return {*}
 */
function validateIDCard (idCard) {
  // 身份证号码长度应该为 18
  if (idCard.length !== 18) {
    return false;
  }

  // 取出身份证号码中的前 17 位和最后一位校验位
  const idCard17 = idCard.substring(0, 17);
  const idCard18Code = idCard.substring(17);

  // 判断前 17 位是否全部为数字
  if (!/^\d+$/.test(idCard17)) {
    return false;
  }

  // 判断省份代码是否正确
  const provinceCode = idCard.substring(0, 2);
  const validProvinceCodes = [
    "11", // 北京市
    "12", // 天津市
    "13", // 河北省
    "14", // 山西省
    "15", // 内蒙古自治区
    "21", // 辽宁省
    "22", // 吉林省
    "23", // 黑龙江省
    "31", // 上海市
    "32", // 江苏省
    "33", // 浙江省
    "34", // 安徽省
    "35", // 福建省
    "36", // 江西省
    "37", // 山东省
    "41", // 河南省
    "42", // 湖北省
    "43", // 湖南省
    "44", // 广东省
    "45", // 广西壮族自治区
    "46", // 海南省
    "50", // 重庆市
    "51", // 四川省
    "52", // 贵州省
    "53", // 云南省
    "54", // 西藏自治区
    "61", // 陕西省
    "62", // 甘肃省
    "63", // 青海省
    "64", // 宁夏回族自治区
    "65", // 新疆维吾尔自治区
    "71", // 台湾省
    "81", // 香港特别行政区
    "82", // 澳门特别行政区
  ];
  if (!validProvinceCodes.includes(provinceCode)) {
    return false;
  }

  // 计算校验位
  let sum = 0;
  for (let i = 0; i < 17; i++) {
    sum += idCard17.charAt(i) * (Math.pow(2, 17 - i) % 11);
  }
  const codes = ["1", "0", "X", "9", "8", "7", "6", "5", "4", "3", "2"];
  const idCard18 = codes[sum % 11];

  // 判断校验位是否正确
  if (idCard18 !== idCard18Code) {
    return false;
  }

  // 验证生日是否合法
  const birthday = idCard.substring(6, 14);
  const year = parseInt(birthday.substring(0, 4));
  const month = parseInt(birthday.substring(4, 6));
  const day = parseInt(birthday.substring(6));
  const currentDate = new Date();
  const currentYear = currentDate.getFullYear();
  const age = currentYear - year;

  // 判断生日是否在有效范围内
  if (year < 1900 || year > currentYear || month < 1 || month > 12 || day < 1 || day > 31) {
    return false;
  }

  // 判断年龄是否超过 150 岁
  if (age > 150) {
    return false;
  }

  // 验证性别是否合法
  const genderCode = idCard.charAt(16);
  const gender = genderCode % 2 === 0 ? "female" : "male";
  if (!gender) {
    return false
  }

  return true;
}
```

测试代码

```
console.log('1', validateIDCard('23090219860613999X'))
console.log('2', validateIDCard('23090219860613998X'))
console.log('3', validateIDCard('230902198606130039'))
console.log('4', validateIDCard('230902198606130038'))
```

#### 校验银行卡号

银行卡号校验通常使用 Luhn 算法来实现，该算法可以验证银行卡号的有效性。以下是使用 JavaScript 实现 Luhn 算法进行银行卡号校验的代码：

校验代码

```
function validateBankCardNumber(cardNumber) {
  // 将银行卡号转换为数组，方便进行操作
  const cardNumberArr = cardNumber.split("");

  // 银行卡号长度必须在 12 ~ 19 位之间
  if (cardNumberArr.length < 12 || cardNumberArr.length > 19) {
    return false;
  }

  // 从倒数第二位开始，对偶数位进行乘2运算
  for (let i = cardNumberArr.length - 2; i >= 0; i -= 2) {
    cardNumberArr[i] = cardNumberArr[i] * 2;
    // 如果乘以2的结果大于等于10，则将结果的十位数和个位数相加
    if (cardNumberArr[i] >= 10) {
      cardNumberArr[i] = Math.floor(cardNumberArr[i] / 10) + (cardNumberArr[i] % 10);
    }
  }

  // 计算所有位数的和
  const sum = cardNumberArr.reduce((acc, curr) => parseInt(acc) + parseInt(curr), 0);

  // 如果所有位数的和是10的倍数，则银行卡号有效
  return sum % 10 === 0;
}
```

该函数接受一个字符串类型的银行卡号作为输入，如果该银行卡号有效，则返回 true，否则返回 false。

测试代码

```
const bankCardNumber = "6222020111122220000";
const isValid = validateBankCardNumber(bankCardNumber);
console.log(isValid); // true

const bankCardNumber2 = "6222020111122220001";
const isValid2 = validateBankCardNumber(bankCardNumber2);
console.log(isValid2); // false
```

上述示例中，validateBankCardNumber 函数分别校验 bankCardNumber 和 bankCardNumber2 是否有效，其中 bankCardNumber 有效，返回值为 true，而 bankCardNumber2 无效，返回值为 false。

#### 校验电子邮箱

校验代码

```
function validateEmail(email) {
// 定义电子邮箱的正则表达式
const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
return emailPattern.test(email);
}
```

该函数接受一个字符串类型的电子邮箱作为输入，如果该电子邮箱格式正确，则返回 true，否则返回 false。

上述代码中，定义了一个正则表达式 emailPattern，该正则表达式匹配符合电子邮箱格式的字符串。具体来说，该正则表达式要求字符串以字母、数字、点号、下划线、百分号、加号、减号开头，后面是一个“@”符号，然后是一个或多个字母、数字、点号、减号的组合，最后以一个点号和至少两个字母结尾。如果输入的字符串符合该正则表达式，则返回 true，否则返回 false。

测试代码

```
const email = "example@domain.com";
const isValid = validateEmail(email);
console.log(isValid); // true

const email2 = "example.domain.com";
const isValid2 = validateEmail(email2);
console.log(isValid2); // false
```

上述示例中，validateEmail 函数分别校验 email 和 email2 是否符合电子邮箱格式，其中 email 符合电子邮箱格式，返回值为 true，而 email2 不符合电子邮箱格式，返回值为 false。

#### 提交时校验是否同意用户协议

通常，校验用户是否选择了同意用户协议可以使用以下方式实现：

首先，可以在 HTML 中添加一个复选框或单选框，用于让用户选择是否同意用户协议。例如：

```
<input type="checkbox" id="agree" name="agree">
<label for="agree">我已阅读并同意用户协议</label>
```

然后，可以在 JavaScript 中获取该复选框或单选框的值，并根据其值来判断用户是否同意用户协议。例如：

```
function validateAgreement() {
  const agreement = document.getElementById("agree");
  if (agreement.checked) {
    return true;
  } else {
    return false;
  }
}
```

该函数获取 id 为 agree 的复选框的值，如果复选框被选中，则返回 true，否则返回 false。

在表单提交时，调用该函数判断用户是否同意用户协议。例如：

```
const form = document.getElementById("form");
form.addEventListener("submit", function(event) {
  if (!validateAgreement()) {
    alert("请同意用户协议");
    event.preventDefault(); // 阻止表单提交
  }
});
```

该代码使用了表单的 submit 事件，当表单被提交时，调用 validateAgreement 函数判断用户是否同意用户协议。如果用户未选择同意用户协议，则弹出提示框并阻止表单提交。

需要注意的是，如果用户未同意用户协议，根据具体业务需求，可以选择弹出提示框或者禁用提交按钮等方式来提醒用户同意用户协议。
