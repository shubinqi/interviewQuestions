<!--
 * @Author: Shu Binqi
 * @Date: 2023-03-03 01:38:37
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-10 16:02:19
 * @Description: 微前端面试题（10题）
 * @Version: 1.0.0
 * @FilePath: \interviewQuestions\前端项目\其他\微前端.md
-->

### 一、微前端

#### 微前端是什么？有什么特点？

微前端是一种将前端应用程序拆分为更小、更独立的部分，然后将这些部分组合在一起以形成一个整体的架构方式。这些小的部分可以由不同的团队开发和维护，以增加整个应用程序的可扩展性和可维护性。

微前端的特点包括：

1. **模块化**：微前端允许应用程序被拆分为多个小的、松耦合的部分，每个部分都可以独立开发、构建和部署。这样可以提高应用程序的可维护性和可扩展性。
1. **独立开发和部署**：每个微前端部分都可以由不同的团队开发和部署，这样可以提高开发和部署的效率。此外，它还可以使团队更加专注于他们负责的功能，而不需要考虑整个应用程序的细节。
1. **运行时整合**：微前端的各个部分可以在运行时整合在一起，以形成一个整体。这使得在部署时可以将每个微前端部分独立部署，并将它们组合在一起以创建一个完整的应用程序。这样可以提高应用程序的可靠性和可维护性。
1. **技术栈无关**：微前端允许使用不同的技术栈来开发每个微前端部分。这意味着每个团队可以使用他们最喜欢的工具来开发应用程序的一部分，而不需要考虑其他部分使用的技术。

总之，微前端可以使得应用程序更加模块化、可维护性更高、开发效率更高，还可以将团队解耦，增加整个应用程序的可扩展性。

#### 脚本隔离和样式隔离怎么实现？

脚本隔离和样式隔离是指在网页或应用程序中，将脚本和样式代码限制在其所在的组件或模块内，以避免它们影响其他部分的代码。这样可以提高应用程序的可维护性和可重用性。

实现脚本隔离和样式隔离的一种常见方法是使用 CSS Modules 和 JavaScript 模块。CSS Modules 可以将样式代码局限于组件范围内，以避免样式的冲突。JavaScript 模块则可以将脚本代码隔离在组件内部，并限制它们的作用域。

以下是具体实现方法：

1. **CSS Modules**：使用 CSS Modules 可以将 CSS 样式代码限制在组件的作用域内，以避免样式冲突。这可以通过为每个组件生成一个唯一的 CSS 类名来实现。当组件被渲染时，其 CSS 类名将自动与该组件的所有样式规则相关联。
1. **JavaScript 模块**：使用 JavaScript 模块可以将脚本代码隔离在组件内部，以避免变量或函数名的冲突。这可以通过使用模块系统（如 CommonJS 或 ES6 模块）来实现。每个组件可以被实现为一个模块，并通过导出所需的函数、变量和类来提供公共 API。

需要注意的是，虽然使用 CSS Modules 和 JavaScript 模块可以实现脚本隔离和样式隔离，但这并不能完全消除应用程序中的样式和脚本冲突。为了确保最佳的隔离效果，应该遵循一些最佳实践，例如避免在全局作用域中声明变量和函数，以及在组件之间共享数据时使用一致的命名约定。

### 二、qiankun 微前端

#### qiankun 微前端实现原理？

qiankun 是一个基于 Single-SPA 的微前端解决方案，它提供了一个能够协调多个独立前端应用的容器，从而实现了微前端的目标：将一个大型应用程序拆分为多个小型的、独立开发的子应用，每个子应用可以独立开发、测试和部署，同时又可以通过容器协同工作，构建一个统一的整体应用。

qiankun 的实现原理如下：

1. **使用 Single-SPA 实现应用间的无缝切换**：Single-SPA 是一个用于实现前端微服务架构的 JavaScript 框架，它可以让多个子应用在同一页面中运行，而且可以通过路由配置实现应用之间的无缝切换。qiankun 基于 Single-SPA 的路由管理能力，将多个独立的子应用组合成一个整体应用。
1. **使用沙箱隔离子应用的运行环境**：qiankun 使用了一个基于浏览器原生的沙箱机制来隔离每个子应用的运行环境，从而避免了子应用之间的命名冲突和全局污染问题。每个子应用都运行在自己的沙箱环境中，它们只能访问自己的全局变量和 DOM，不能访问其他子应用的变量和 DOM。
1. **使用 Proxy 拦截跨域请求**：在 qiankun 中，子应用的请求可能会涉及到跨域问题，为了解决这个问题，qiankun 使用了 Proxy 技术来拦截和转发子应用的跨域请求，从而使得子应用可以无缝地访问外部接口。
1. **使用自定义 Loader 加载子应用**：qiankun 支持使用自定义 Loader 来加载子应用，这样可以让每个子应用只需要加载自己需要的资源，从而提高应用的加载速度。qiankun 提供了多种不同类型的 Loader，例如预加载、按需加载等，可以根据不同的需求选择合适的 Loader。

总之，qiankun 的微前端实现原理基于 Single-SPA，通过沙箱隔离、Proxy 技术和自定义 Loader 等方式，实现了多个独立前端应用的协同工作，从而构建了一个整体的微前端应用。

#### Single-SPA 是什么？

Single-SPA（Single Page Application）是一个用于构建微前端应用的 JavaScript 前端框架。它允许开发人员将不同的 JavaScript 应用程序（例如 React、Angular、Vue.js 等）组合成单个应用程序，以实现一致的用户体验。

Single-SPA 提供了一个基于路由的组件加载机制，使得不同应用程序可以共享相同的页面和路由，并能够以惰性方式加载和卸载组件，从而提高应用程序的性能和响应速度。此外，Single-SPA 还提供了一组工具和生命周期钩子，使得不同的应用程序可以在同一个页面上共存，并且能够在应用程序之间进行通信和交互。

Single-SPA 的优势在于它可以解决传统多页面应用中的很多问题，例如路由管理、状态管理、代码复用等等。同时，它还可以提高应用程序的可维护性和扩展性，允许开发人员根据需要对应用程序进行模块化开发和部署。

总之，Single-SPA 是一个非常有用的微前端框架，可以帮助开发人员快速构建高性能、可维护和可扩展的微前端应用程序。

#### qiankun 微前端怎么保证子应用不互相影响？

在 qiankun 微前端框架中，每个子应用运行在自己的沙箱环境中，从而避免了子应用之间的命名冲突和全局污染问题，保证了子应用之间的互相隔离，不会相互影响。

具体来说，qiankun 采用了以下技术手段来保证子应用之间的隔离：

1. **使用沙箱隔离**：qiankun 基于浏览器原生的沙箱机制来隔离每个子应用的运行环境，每个子应用运行在自己的沙箱环境中，它们只能访问自己的全局变量和 DOM，不能访问其他子应用的变量和 DOM。这样可以避免子应用之间的全局变量冲突和命名空间污染问题。
1. **使用自定义事件通信**：qiankun 提供了一个自定义事件机制，可以让不同的子应用之间通过自定义事件来进行通信。通过这种方式，子应用可以在不互相干扰的情况下，进行数据交互和状态同步。
1. **使用 Proxy 拦截跨域请求**：在 qiankun 中，子应用的请求可能会涉及到跨域问题，为了解决这个问题，qiankun 使用了 Proxy 技术来拦截和转发子应用的跨域请求，从而使得子应用可以无缝地访问外部接口。这样，不同子应用之间的网络请求也可以被隔离开来，不会互相影响。

总之，通过沙箱隔离、自定义事件机制和 Proxy 技术等手段，qiankun 微前端框架可以有效地保证子应用之间的隔离，避免子应用之间的互相影响。

#### qiankun 的沙箱隔离怎么实现的？有什么优缺点？

qiankun 微前端框架的沙箱隔离是基于浏览器提供的原生沙箱机制来实现的。具体来说，qiankun 在每个子应用运行的时候，会创建一个全局的 iframe 对象，每个子应用都在自己的 iframe 中运行，从而实现了沙箱隔离。每个 iframe 中都有自己的 JavaScript 执行环境、DOM 树和全局变量，不同 iframe 中的 JavaScript 代码是相互隔离的，这样就能够避免子应用之间的命名冲突和全局污染问题，保证了子应用之间的互相隔离，不会相互影响。

qiankun 沙箱隔离的优点是：

1. **安全性高**：沙箱隔离可以防止恶意代码访问和修改其他子应用的数据和状态，保证应用程序的安全性。
1. **稳定性高**：每个子应用都运行在自己的沙箱环境中，避免了全局变量冲突和命名空间污染问题，保证了应用程序的稳定性和可靠性。
1. **扩展性好**：沙箱隔离可以方便地扩展和添加新的子应用，同时支持不同的应用程序使用不同的技术栈和框架，从而提高了应用程序的可扩展性和灵活性。

不过，沙箱隔离也有一些缺点，例如：

1. **性能问题**：每个子应用都需要在自己的 iframe 中运行，可能会造成一些性能问题，例如额外的网络请求和 DOM 操作等。
1. **跨域问题**：不同子应用之间的通信和交互可能会涉及到跨域问题，需要使用一些特殊的技术手段来解决。

总之，qiankun 的沙箱隔离机制可以有效地保证子应用之间的隔离和安全性，同时也可以提高应用程序的可扩展性和灵活性，但是也需要注意一些性能和跨域问题。

#### qiankun 微前端不同子应用如何公用代码？

在 qiankun 微前端框架中，不同的子应用之间可以通过共享模块的方式来公用代码。具体来说，可以将一些公共的代码（例如 React、Vue、Antd 等 UI 库）打包成一个独立的模块，然后在需要使用的子应用中引入这个模块，从而实现代码的复用和共享。

qiankun 提供了多种方式来实现共享模块的功能，例如：

1. **基于 webpack 的模块共享**：使用 webpack 来打包和分发共享模块，然后在子应用中通过动态加载方式引入共享模块。这种方式需要在 qiankun 的主应用中配置 webpack 配置文件，从而实现代码的打包和分发。
1. **基于 SystemJS 的模块共享**：使用 SystemJS 来加载和解析模块，从而实现模块的共享。这种方式需要在 qiankun 的主应用中配置 SystemJS 模块加载器，从而实现模块的加载和解析。
1. **基于 CDN 的模块共享**：使用 CDN 来分发共享模块，从而避免了子应用之间的依赖和冲突问题。这种方式需要将共享模块上传到 CDN 上，并在子应用中通过 script 标签来引入共享模块。

总之，qiankun 微前端框架提供了多种方式来实现不同子应用之间的代码共享，开发人员可以根据具体的业务需求和技术架构来选择合适的方式。

#### qiankun 微前端如何实现自定义事件通信？

qiankun 微前端框架提供了两种方式来实现自定义事件通信，分别是基于 props 传递和基于全局事件总线。

1. **基于 props 传递**：可以通过 props 将事件传递给子应用，从而实现不同子应用之间的通信。具体来说，可以在父应用中定义一个回调函数，然后将这个回调函数通过 props 传递给子应用。当子应用中需要触发这个事件时，就可以调用这个回调函数，从而实现通信。
1. **基于全局事件总线**：可以在 qiankun 的主应用中定义一个全局事件总线，然后在子应用中通过这个事件总线来实现事件的触发和监听。具体来说，可以在主应用中使用类似于 Vue、React 等框架提供的事件总线或者自己手动实现一个事件总线，并将这个事件总线传递给子应用。当子应用中需要触发或监听事件时，就可以通过这个事件总线来实现通信。

在使用自定义事件通信时，需要注意以下几点：

1. 在使用基于 props 传递的方式时，需要确保事件传递的正确性和及时性，否则可能会出现通信延迟或者通信失败的问题。
1. 在使用基于全局事件总线的方式时，需要避免事件冲突和命名空间问题，可以使用类似于命名空间的方式来区分不同子应用的事件。
1. 在使用自定义事件通信时，需要注意安全性和可靠性，避免出现 XSS 攻击等安全问题。
