<!--
 * @Author: Shu Binqi
 * @Date: 2023-03-14 19:47:50
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-14 19:47:52
 * @Description: DOM 树
 * @Version: 1.0.0
 * @FilePath: \interviewQuestions\前端基础\浏览器\DOM树.md
-->

#### DOM 树是怎么生成的？

DOM（Document Object Model）树是表示 HTML 文档的树形结构，通过将 HTML 文档解析成一个由节点和对象组成的树形结构来表示文档。

当浏览器请求一个 HTML 页面时，它会根据 HTML 标签的结构和内容创建一个 DOM 树。DOM 树包括以下类型的节点：

1. **元素节点**：表示 HTML 元素。
1. **文本节点**：表示 HTML 元素的文本内容。
1. **属性节点**：表示 HTML 元素的属性。

DOM 树生成的过程可以分为以下几个步骤：

1. 浏览器将 HTML 文档解析成一个由节点和对象组成的树形结构，每个节点都对应着文档中的一个元素或标签。
1. 浏览器通过解析 HTML 文档中的标记语言，将 HTML 标记解析成元素节点、文本节点或属性节点，并根据它们的层次关系组织成一个树形结构。
1. 浏览器根据元素的层次结构和样式规则计算每个元素的样式信息。
1. 浏览器使用 DOM 树来渲染页面，并且将页面显示给用户。

在生成 DOM 树的过程中，浏览器会执行一些特殊的操作，如处理文档类型、注释、空白字符等。如果遇到错误的 HTML 标记，则浏览器会尝试自动修正错误，以便创建一个有效的 DOM 树。

总的来说，生成 DOM 树是浏览器解析 HTML 文档的过程，该过程将 HTML 标记解析成节点，并将这些节点组织成一个树形结构。生成的 DOM 树可以通过 JavaScript 操作，动态地修改和更新页面内容，实现动态交互和响应用户的操作。

#### 浏览器解析 DOM 的具体过程

浏览器解析 DOM 的过程通常被称为 DOM 构建（DOM construction）。DOM 构建的过程大致可以分为以下几个步骤：

1. **解析 HTML 文件**：浏览器会从服务器或本地缓存中获取 HTML 文件，然后根据 HTML 文件的文本内容构建一个 DOM 树的根节点 document 对象。
1. **标记化**（Tokenization）：浏览器将 HTML 文件的文本内容按照一定规则（比如标签、属性、文本等）分成一系列的标记（Tokens）。
1. **构建 DOM 树**：浏览器将这些标记转化为 DOM 节点，按照 HTML 文件中的层次结构，逐级构建 DOM 树。
1. **样式计算**：浏览器根据 CSS 样式表中的规则，计算出每个节点的具体样式信息，并将其应用到节点上。
1. **布局计算**：浏览器根据 DOM 树中每个节点的样式信息，计算出每个节点在屏幕上的大小和位置。
1. **绘制和渲染**：浏览器根据计算得到的每个节点的大小和位置信息，将节点绘制到屏幕上，并按照一定的规则将它们合并成最终的页面渲染结果。

需要注意的是，DOM 树的构建过程是在 HTML 文件解析完成后进行的，因此如果 HTML 文件中存在一些 JavaScript 代码或外部资源的引用，浏览器需要先执行这些代码或加载这些资源，才能继续构建 DOM 树。这也是为什么页面渲染的速度会受到 JavaScript 代码和外部资源加载速度的影响。
