<!--
 * @Author: Shu Binqi
 * @Date: 2023-03-06 00:11:18
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-10 22:59:11
 * @Description: 八股文：前端安全（XSS、CSRF）
 * @Version: 1.0.0
 * @FilePath: \interviewQuestions\八股文\计算机网络\前端安全.md
-->

#### 有哪些能引起前端安全的问题？

前端安全问题主要包括以下几种：

1. **XSS 攻击（Cross-Site Scripting）**，即跨站脚本攻击。攻击者通过注入恶意脚本代码来攻击用户浏览器，获取用户的敏感信息，如 cookie、session 等。
1. **CSRF 攻击（Cross-Site Request Forgery）**，即跨站请求伪造。攻击者通过引导用户进入恶意网站，来伪造用户的请求，对目标网站进行操作，如盗取用户信息、发表文章等。
1. **点击劫持（Clickjacking）**，即点击劫持攻击。攻击者通过伪造页面将用户的点击操作劫持到恶意链接上，使得用户不知不觉地执行了攻击者的操作。
1. **iframe 劫持**：攻击者通过在自己的网站中嵌入 iframe，从而获取用户的敏感信息。开发者可以通过检测当前网站是否被第三方 iframe 引用的方式来防范 iframe 劫持。
1. **HTTP 劫持**，即攻击者通过一些手段拦截用户请求，篡改用户请求的内容，窃取用户敏感信息等。
1. **资源文件劫持**，即攻击者通过修改 DNS 等方式，将用户请求的资源文件重定向到恶意网站上，实现攻击。
1. **数据泄露**，即在数据传输过程中，由于没有加密或者加密不足，使得敏感数据被攻击者获取。

以上是常见的前端安全问题，需要前端开发者在开发时注意安全防范，采取一些措施来保护用户数据安全，如使用 HTTPS 加密传输数据，避免 XSS 攻击等。

#### 什么是 XSS（Cross-Site Scripting - 跨站脚本） 攻击？

（1）概念

XSS（Cross-Site Scripting，为了和 CSS 进行区分，故简写为 XSS）攻击指的是**跨站脚本攻击**，是一种代码注入攻击。攻击者通过在网站注入恶意脚本，使之在用户的浏览器上运行，从而盗取用户的信息如 cookie 等。

XSS 的本质是因为网站没有对恶意代码进行过滤，与正常的代码混合在一起了，浏览器没有办法分辨哪些脚本是可信的，从而导致了恶意代码的执行。

攻击者可以通过这种攻击方式可以进行以下操作：

- 获取页面的数据，如 DOM、cookie、localStorage；
- DOS 攻击，发送合理请求，占用服务器资源，从而使用户无法访问服务器；
- 破坏页面结构；
- 流量劫持（将链接指向某网站）；

（2）攻击类型

XSS 可以分为存储型、反射型和 DOM 型：

- 存储型指的是恶意脚本会存储在目标服务器上，当浏览器请求数据时，脚本从服务器传回并执行。
- 反射型指的是攻击者诱导用户访问一个带有恶意代码的 URL 后，服务器端接收数据后处理，然后把带有恶意代码的数据发送到浏览器端，浏览器端解析这段带有 XSS 代码的数据后当做脚本执行，最终完成 XSS 攻击。
- DOM 型指的通过修改页面的 DOM 节点形成的 XSS。

1）存储型 XSS 的攻击步骤：

- 攻击者将恶意代码提交到目标网站的数据库中。
- 用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器。
- 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
- 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、⽤户私信等。

2）反射型 XSS 的攻击步骤：

- 攻击者构造出特殊的 URL，其中包含恶意代码。
- 用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。
- 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
- 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。

反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。 由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。

3）DOM 型 XSS 的攻击步骤：

- 攻击者构造出特殊的 URL，其中包含恶意代码。
- 用户打开带有恶意代码的 URL。
- 用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。
- 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

DOM 型 XSS 跟前两种 XSS 的区别：DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 都属于服务端的安全漏洞。

#### 如何防御 XSS 攻击？

可以看到 XSS 危害如此之大， 那么在开发网站时就要做好防御措施，具体措施如下：

- 可以从浏览器的执行来进行预防，一种是使用纯前端的方式，不用服务器端拼接后返回（不使用服务端渲染）。另一种是对需要插入到 HTML 中的代码做好充分的转义。对于 DOM 型的攻击，主要是前端脚本的不可靠而造成的，对于数据获取渲染和字符串拼接的时候应该对可能出现的恶意代码情况进行判断。
- 使用 CSP ，CSP 的本质是建立一个白名单，告诉浏览器哪些外部资源可以加载和执行，从而防止恶意代码的注入攻击。
- - CSP 指的是内容安全策略，它的本质是建立一个白名单，告诉浏览器哪些外部资源可以加载和执行。我们只需要配置规则，如何拦截由浏览器自己来实现。
  - 通常有两种方式来开启 CSP，一种是设置 HTTP 首部中的 Content-Security-Policy，一种是设置 meta 标签的方式
- 对一些敏感信息进行保护，比如 cookie 使用 http-only，使得脚本无法获取。也可以使用验证码，避免脚本伪装成用户执行一些操作。

#### 什么是 CSRF（Cross-Site Request Forgeries - 跨站点请求伪造）攻击？

（1）概念

> CSRF 攻击指的是**跨站点请求伪造攻击**，攻击者诱导用户进入一个第三方网站，然后该网站向被攻击网站发送跨站请求。如果用户在被攻击网站中保存了登录状态，那么攻击者就可以利用这个登录状态，绕过后台的用户验证，冒充用户向服务器执行一些操作。

CSRF 攻击的本质是利用 cookie 会在同源请求中携带发送给服务器的特点，以此来实现用户的冒充。

（2）攻击类型

常见的 CSRF 攻击有三种：

- GET 类型的 CSRF 攻击，比如在网站中的一个 img 标签里构建一个请求，当用户打开这个网站的时候就会自动发起提交。
- POST 类型的 CSRF 攻击，比如构建一个表单，然后隐藏它，当用户进入页面时，自动提交这个表单。
- 链接类型的 CSRF 攻击，比如在 a 标签的 href 属性里构建一个请求，然后诱导用户去点击。

#### 如何防御 CSRF 攻击？

CSRF 攻击可以使用以下方法来防护：

- 进行同源检测，服务器根据 http 请求头中 origin 或者 referer 信息来判断请求是否为允许访问的站点，从而对请求进行过滤。当 origin 或者 referer 信息都不存在的时候，直接阻止请求。这种方式的缺点是有些情况下 referer 可以被伪造，同时还会把搜索引擎的链接也给屏蔽了。所以一般网站会允许搜索引擎的页面请求，但是相应的页面请求这种请求方式也可能被攻击者给利用。（Referer 字段会告诉服务器该网页是从哪个页面链接过来的）
- 使用 CSRF Token 进行验证，服务器向用户返回一个随机数 Token ，当网站再次发起请求时，在请求参数中加入服务器端返回的 token ，然后服务器对这个 token 进行验证。这种方法解决了使用 cookie 单一验证方式时，可能会被冒用的问题，但是这种方法存在一个缺点就是，我们需要给网站中的所有请求都添加上这个 token，操作比较繁琐。还有一个问题是一般不会只有一台网站服务器，如果请求经过负载平衡转移到了其他的服务器，但是这个服务器的 session 中没有保留这个 token 的话，就没有办法验证了。这种情况可以通过改变 token 的构建方式来解决。
- 对 Cookie 进行双重验证，服务器在用户访问网站页面时，向请求域名注入一个 Cookie，内容为随机字符串，然后当用户再次向服务器发送请求的时候，从 cookie 中取出这个字符串，添加到 URL 参数中，然后服务器通过对 cookie 中的数据和参数中的数据进行比较，来进行验证。使用这种方式是利用了攻击者只能利用 cookie，但是不能访问获取 cookie 的特点。并且这种方法比 CSRF Token 的方法更加方便，并且不涉及到分布式访问的问题。这种方法的缺点是如果网站存在 XSS 漏洞的，那么这种方式会失效。同时这种方式不能做到子域名的隔离。
- 在设置 cookie 属性的时候设置 Samesite ，限制 cookie 不能作为被第三方使用，从而可以避免被攻击者利用。Samesite 一共有两种模式，一种是严格模式，在严格模式下 cookie 在任何情况下都不可能作为第三方 Cookie 使用，在宽松模式下，cookie 可以被请求是 GET 请求，且会发生页面跳转的请求所使用。

#### 什么叫 CC 攻击？什么叫 DDOS 攻击？

CC 攻击和 DDoS 攻击都是网络安全领域中的术语，具体含义如下：

1. **CC 攻击**（Challenge Collapsar Attack）：也称为拒绝服务攻击（DoS），是一种通过向服务器发送大量请求来耗尽服务器资源的攻击方式。攻击者通常使用大量的计算机或者僵尸网络（Botnet）向服务器发送大量的请求，以达到让目标服务器无法处理其他合法请求的目的。
1. **DDoS 攻击**（Distributed Denial of Service Attack）：是一种更为高级的攻击方式，与 CC 攻击相比，它通过同时利用大量的计算机或者僵尸网络来攻击一个目标服务器，从而使目标服务器无法正常工作。攻击者通常利用大量的计算机或者设备向目标服务器发送大量的请求，以达到让目标服务器无法处理其他合法请求的目的。

总的来说，CC 攻击是单点攻击，而 DDoS 攻击则是分布式攻击。DDoS 攻击更为复杂，也更为难以防御，因此需要采取更为严密的安全措施。

#### 如何防御 CC 攻击和 DDOS 攻击？

CC 攻击和 DDOS 攻击是常见的网络安全威胁，对于网站和网络服务器的安全和可用性都具有很大的影响。以下是一些防御 CC 攻击和 DDOS 攻击的方法：

1. **配置防火墙**：通过配置网络防火墙，限制对系统的访问，只允许特定的 IP 地址或 IP 地址段进行访问，可以大大减少非法流量的访问。
1. **限制连接数**：通过设置连接限制，限制同一 IP 地址的最大连接数或同时连接数，可以减少 CC 攻击和 DDOS 攻击。
1. **使用反向代理**：通过使用反向代理，可以将访问流量分散到不同的服务器上，减少单个服务器的负载，从而减轻 CC 攻击和 DDOS 攻击的影响。
1. **加强服务器安全性**：通过加强服务器的安全性，包括操作系统和应用程序的安全性，以及定期更新和维护服务器，可以减少系统被攻击的风险。
1. **使用 CDN 加速服务**：通过使用 CDN（内容分发网络）加速服务，可以将网站内容分发到多个节点上，从而减少单个服务器的负载，提高网站的可用性和安全性。
1. **使用流量清洗服务**：流量清洗服务可以检测和清除恶意流量，减少 CC 攻击和 DDOS 攻击的影响，同时可以保护网站的安全和可用性。
1. **定期备份数据**：定期备份数据可以在网站受到攻击时，快速恢复数据和服务，减少损失。

总之，防御 CC 攻击和 DDOS 攻击需要多种手段和策略的综合应用，可以有效减少攻击的影响和损失。

#### 什么是网站数据库注入？

网站数据库注入是一种常见的网络攻击方式，它是通过向一个网站或应用程序的数据库中注入恶意代码，以获取敏感数据、破坏系统或进行其他不当行为的攻击方式。

攻击者通过在输入框中输入特定的恶意代码，来欺骗应用程序的数据库执行攻击者所构造的 SQL 查询语句，从而可以绕过应用程序的身份验证和访问控制机制，获取用户数据或者直接对数据库进行篡改、删除等操作。

网站数据库注入的攻击方式有多种形式，例如 SQL 注入、XPath 注入、LDAP 注入等，攻击的方式也有多种途径，如手动注入、自动化工具注入等。因此，网站数据库注入对网站和应用程序的安全构成严重威胁，需要采取相应的安全措施来防御和预防。例如加强数据输入的过滤和验证，使用安全的编程语言和框架，定期进行漏洞扫描和安全测试等。

#### 防止网站数据库注入攻击？

以下是一些防止网站数据库注入攻击的方法：

1. **输入验证**：所有输入都应该验证和过滤，确保只有预期的输入才能通过。例如，可以检查输入是否符合预期格式、长度、类型等。
1. **使用参数化查询**：使用参数化查询可以将用户提供的数据与查询语句分开，从而防止攻击者在查询语句中插入恶意代码。参数化查询是许多 Web 框架和库的默认选项，应该尽可能使用它们。
1. **最小化权限**：数据库用户应该只具有执行其任务所需的最低权限，这可以限制攻击者可以访问和更改的数据量。
1. **防火墙**：使用防火墙可以帮助防止攻击者访问数据库和其他敏感信息。例如，可以限制对数据库服务器的远程访问，并只允许来自特定 IP 地址的请求通过。
1. **错误信息**：Web 应用程序应该避免向用户披露敏感信息，例如错误消息、堆栈跟踪等，因为这些信息可能会泄露有关系统和数据库的详细信息，从而帮助攻击者发现漏洞。
1. **更新和补丁**：及时更新 Web 应用程序和数据库管理系统，并安装已知的安全漏洞修补程序，以保持系统的安全性。
1. **安全编程实践**：开发人员应该了解安全编程实践，并在编写代码时使用它们。例如，避免使用拼接字符串来构造 SQL 查询语句，而是使用参数化查询等。

综上所述，防止网站数据库注入攻击需要综合运用多种方法和策略，包括输入验证、参数化查询、最小化权限、使用防火墙、错误信息处理、更新和补丁、安全编程实践等。
