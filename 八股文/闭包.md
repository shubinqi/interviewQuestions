<!--
 * @Author: Shu Binqi
 * @Date: 2023-02-24 21:47:19
 * @LastEditors: Shu Binqi
 * @LastEditTime: 2023-03-02 00:56:49
 * @Description: 八股文：闭包
 * @Version: 1.0.0
 * @FilePath: \interviewQuestions\八股文\闭包.md
-->

#### 讲一下闭包？闭包的优缺点？闭包的使用场景？（建议写博客）

闭包是指在函数内部创建了一个函数，并且这个函数可以访问到外部函数的局部变量和参数，即使外部函数已经返回，内部函数仍然可以访问和操作这些变量和参数。闭包是 JavaScript 中一个非常重要的概念，它可以用来实现模块化、保存私有变量等。

闭包 = 函数 + 自由变量

闭包的优点：

1. 实现函数内部的私有变量，避免全局变量的污染。
1. 可以实现数据的封装和隐藏，确保数据的安全性。
1. 使函数内部的变量长期保存在内存中，方便以后的调用。

闭包的缺点：

1. 过度使用闭包可能会导致内存泄漏，因为闭包会使得函数中的变量被长期占用，无法被垃圾回收器回收。
1. 可能会导致性能问题，因为闭包中涉及到了变量的查找，会比普通的函数调用消耗更多的时间和内存。
1. 对于不慎使用闭包的开发者来说，可能会出现变量覆盖等问题。

闭包的使用场景包括但不限于以下几个方面：

1. **模块化开发**：通过闭包来实现模块化开发，将模块中需要暴露的接口通过返回函数的形式暴露出去，同时保护模块中的私有变量。
1. **私有变量**：闭包可以用来实现 JavaScript 中的私有变量，将需要保护的变量封装在一个函数内部，通过返回一个访问该变量的函数，从而控制对变量的访问和修改。
1. **延迟执行**：利用闭包来延迟函数的执行，在函数外部创建一个闭包，然后将需要延迟执行的函数作为参数传入，从而实现延迟执行的效果。
1. **计数器**：闭包可以用来实现一个简单的计数器，每次调用计数器函数都会返回一个新的计数值。
1. **缓存**：利用闭包来实现缓存机制，将需要缓存的数据存储在闭包中，从而提高访问速度。
1. **回调函数**：利用闭包来实现回调函数，将回调函数作为参数传入，从而实现函数之间的协作。

需要注意的是，闭包会占用内存，并且可能会导致内存泄漏，因此在使用闭包时需要注意内存管理。

#### 闭包的执行过程？

闭包是指有权访问另一个函数作用域中变量的函数，即使外部函数已经执行结束，内部函数依然可以访问外部函数的作用域。

当一个函数被调用时，都会创建一个执行环境，包含函数的参数、局部变量、this 等。在执行环境中，会创建一个变量对象（VO），用于存储变量和函数声明，并将其放入作用域链中。

当函数执行完毕时，其执行环境会被销毁，但是其作用域链中的变量对象依然存在，因为闭包函数依然引用了该变量对象，所以该变量对象不能被销毁，直到闭包函数被销毁时才会一起销毁。

下面是一个简单的闭包例子：

```
function outer() {
  var count = 0;
  return function inner() {
    count++;
    console.log(count);
  }
}

var counter = outer();
counter(); // 输出1
counter(); // 输出2
counter(); // 输出3
```

在上面的例子中，调用 outer 函数返回一个内部函数 inner，该内部函数引用了 outer 函数中的变量 count。当执行完 outer 函数后，其执行环境被销毁，但是变量 count 依然存在，因为内部函数 inner 引用了它。所以每次调用 counter 函数时，count 都会累加并输出。

这就是闭包的执行过程：当函数执行完毕后，其执行环境会被销毁，但是变量对象依然存在于作用域链中，直到闭包函数被销毁时才会一起销毁。
